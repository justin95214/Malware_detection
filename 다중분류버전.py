import pandas as pd
import numpy as np
from sklearn.preprocessing import LabelEncoder, MinMaxScaler
from keras.utils import np_utils
from keras.models import Sequential
from keras.layers.core import Dense



csv_data = pd.read_csv("C:/Users/user/Desktop/feature_confirm.csv", sep =',')

print("--------------------------------------------------------------------------")
print(type(csv_data))
print(csv_data)

print(csv_data.shape)
print(csv_data.columns)

new_data = csv_data.drop('family', axis= 1)
print(new_data)
selected_data = new_data

selected_list =list(selected_data)
print(selected_list)

#sns.pairplot(csv_data, hue= 'family');
#plt.show()
scaler = MinMaxScaler()
new_data = scaler.fit_transform(new_data)

X = new_data.astype(float)
Y_obj = csv_data['family']

e =LabelEncoder()
e.fit(Y_obj)
Y = e.transform(Y_obj)
Y_encoded = np_utils.to_categorical(Y)

model = Sequential()

model.add(Dense(189, input_dim= 235, activation='linear'))
model.add(Dense(189,activation='softmax'))

model.compile(loss= 'categorical_crossentropy', optimizer= 'adam', metrics=['accuracy'])

model.fit(X,Y_encoded, epochs= 50, batch_size = 1)
print("\n accurancy :  %.4f" %(model.evaluate(X,Y_encoded)[1]))
